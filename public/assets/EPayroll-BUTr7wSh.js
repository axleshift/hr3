import{r as l,j as e,C as j}from"./index-BregGavu.js";import{a as p}from"./axios-DXsv3KKR.js";import{b as C,a as u}from"./index-2GwXPYeC.js";import{C as b,a as f}from"./CCardBody--BWERNhg.js";import{C as g}from"./CCardHeader-BeNLNKIv.js";import{C as w,a as k,b as n,e as c,d as E,c as t}from"./CTable-L5YcJro0.js";const $=()=>{const[i,h]=l.useState([]),[m,d]=l.useState(!0);l.useEffect(()=>{(async()=>{try{const r=sessionStorage.getItem("token"),s=await p.get("http://localhost:8000/api/payrolls/${employeeId}",{headers:{Authorization:`Bearer ${r}`}});console.log(s.data),Array.isArray(s.data)?h(s.data):console.error("Data is not an array",s.data),d(!1)}catch(r){console.error("Error fetching payrolls:",r),d(!1)}})()},[]);const x=async a=>{try{const r=sessionStorage.getItem("token"),s=await p.get(`http://localhost:8000/api/payrolls/${a}/download`,{headers:{Authorization:`Bearer ${r}`},responseType:"blob"}),y=window.URL.createObjectURL(new Blob([s.data])),o=document.createElement("a");o.href=y,o.setAttribute("download",`payslip_${a}.pdf`),document.body.appendChild(o),o.click()}catch(r){console.error("Error downloading payslip:",r),alert("Unable to download payslip.")}};return e.jsx(C,{children:e.jsxs(b,{className:"mt-4",children:[e.jsx(g,{children:e.jsx("h5",{children:"Payroll"})}),e.jsx(f,{children:m?e.jsxs("div",{className:"text-center",children:[e.jsx(j,{color:"primary"}),e.jsx("p",{children:"Loading payrolls..."})]}):e.jsxs(w,{hover:!0,responsive:!0,children:[e.jsx(k,{children:e.jsxs(n,{children:[e.jsx(c,{scope:"col",children:"Disbursement Date"}),e.jsx(c,{scope:"col",children:"Amount"}),e.jsx(c,{scope:"col",children:"Payslip"})]})}),e.jsx(E,{children:i.length>0?i.map(a=>e.jsxs(n,{children:[e.jsx(t,{children:a.disbursement}),e.jsx(t,{children:a.netSalary}),e.jsx(t,{children:e.jsx(u,{color:"primary",onClick:()=>x(a.id),children:"Download"})})]},a.id)):e.jsx(n,{children:e.jsx(t,{colSpan:"3",className:"text-center",children:"No payroll data available."})})})]})})]})})};export{$ as default};
