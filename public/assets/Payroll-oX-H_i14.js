import{r as a,i as k,j as e,C as u}from"./index-BregGavu.js";import{a as y}from"./axios-DXsv3KKR.js";import{a as r,F as f,s as A,t as B}from"./index-2GwXPYeC.js";import{e as F}from"./employee-BtHkxQvA.js";import{C as z,a as I}from"./CRow-DCQtSTwn.js";import{C as R,a as $}from"./CCardBody--BWERNhg.js";import{C as H}from"./CCardHeader-BeNLNKIv.js";import{C as _,a as L,b as h,c as l,d as W}from"./CTable-L5YcJro0.js";import{C as q,a as G,b as J}from"./CModalFooter-OEiGzLA6.js";import"./DefaultLayout-CNKZtyqM.js";const le=()=>{const[C,g]=a.useState(!0),[m,x]=a.useState([]),[b,n]=a.useState(!1),[N,i]=a.useState(""),[c,S]=a.useState(null),[o,j]=a.useState(!1),[d,M]=a.useState(!1),p=k();a.useEffect(()=>{y.get("http://localhost:8000/api/payrolls").then(s=>{s.status===200&&x(s.data.payrolls||[])}).catch(s=>{console.error("Error fetching payrolls:",s)}).finally(()=>g(!1))},[]);const P=s=>F.find(t=>t.employee_id===s)||{},D=()=>{c&&(j(!0),y.delete(`http://localhost:8000/api/deletepayroll/${c}`).then(s=>{s.data.status===200?(i("Payroll record deleted successfully!"),x(t=>t.filter(T=>T.id!==c)),M(!0)):s.data.status===404&&i("Error: "+s.data.message)}).catch(()=>{i("An error occurred while deleting the payroll record.")}).finally(()=>{n(!0),j(!1),S(null)}))},v=s=>{window.open(`http://localhost:8000/api/payroll/${s}/payslip`,"_blank")},E=()=>{p("/addpayroll")},w=s=>{p(`/editpayroll/${s}`)};return C?e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"100vh"},children:e.jsx(u,{color:"primary"})}):e.jsxs("div",{className:"container",children:[e.jsx(z,{children:e.jsx(I,{className:"col-md-12",children:e.jsxs(R,{children:[e.jsxs(H,{children:[e.jsx("strong",{children:"Manage Payroll"}),e.jsx(r,{color:"primary",size:"sm",className:"float-end",onClick:E,children:"Add Payroll"})]}),e.jsx($,{children:e.jsxs(_,{bordered:!0,hover:!0,responsive:!0,children:[e.jsx(L,{children:e.jsxs(h,{className:"text-center",style:{fontWeight:"bold"},children:[e.jsx(l,{children:"#"}),e.jsx(l,{children:"Employee Name"}),e.jsx(l,{children:"Account Number"}),e.jsx(l,{children:"Department"}),e.jsx(l,{children:"Basic Salary"}),e.jsx(l,{children:"Status"}),e.jsx(l,{children:"Payment Method"}),e.jsx(l,{children:"Actions"})]})}),e.jsx(W,{className:"text-center",children:m.length>0?m.map(s=>{const t=P(s.employeeId);return e.jsxs(h,{children:[e.jsx(l,{children:s.employeeId}),e.jsx(l,{children:t.name}),e.jsx(l,{children:t.accountNumber}),e.jsx(l,{children:t.department}),e.jsx(l,{children:s.basicSalary}),e.jsx(l,{children:s.status}),e.jsx(l,{children:s.paymentMethod}),e.jsxs(l,{children:[e.jsx(r,{className:"me-2",color:"success",size:"sm",onClick:()=>w(s.id),children:e.jsx(f,{icon:A})}),e.jsx(r,{className:"me-2",color:"info",size:"sm",onClick:()=>v(s.id),children:e.jsx(f,{icon:B})})]})]},s.id)}):e.jsx(h,{children:e.jsx(l,{colSpan:"8",className:"text-center",children:"No payroll data available."})})})]})})]})})}),e.jsxs(q,{visible:b,onClose:()=>n(!1),children:[e.jsx(G,{children:o?e.jsx(u,{color:"primary"}):N}),e.jsxs(J,{children:[e.jsx(r,{color:"secondary",onClick:()=>n(!1),disabled:o||d,children:"Cancel"}),e.jsx(r,{color:"danger",onClick:D,disabled:o||d,children:o?"Deleting...":d?"Deleted":"Delete"})]})]})]})};export{le as default};
