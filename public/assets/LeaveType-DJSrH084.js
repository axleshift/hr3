import{r as c,j as e}from"./index-CD-NJnkg.js";import{a as b}from"./api-rGiqx8rl.js";import{a as d,F as _,r as q,s as G,t as J}from"./index-DeBBGyvN.js";import{C as K,a as O}from"./CCardBody-DyFzM2Ly.js";import{C as Q}from"./CCardHeader-BhrbU1Pe.js";import{C as T}from"./CAlert-C_FjY2gZ.js";import{C as W,a as X,b as L,c as m,d as Z,e as p}from"./CTable-pqzZLYyp.js";import{a as ee}from"./DefaultLayout-DPTQgNH1.js";import{C as F,a as M,b as U,c as S}from"./CModalTitle-BnWPEEUA.js";import{C as o}from"./CFormControlWrapper-CaZ-vSMc.js";import{C as v}from"./CFormInput-B0AaJpyw.js";import{C as g}from"./CFormSelect-CwpEuRxZ.js";import{C as R}from"./CModalFooter-BNlOJ0Ac.js";import"./index-xsH4HHeE.js";const xe=()=>{const[x,C]=c.useState([]),[Y,u]=c.useState(!1),[k,f]=c.useState(!1),[h,l]=c.useState(""),[i,N]=c.useState({name:"",type:"Paid",pay_rate:100,is_convertible:"No",conversion_rate:100}),[t,E]=c.useState({id:null,name:"",type:"Paid",pay_rate:100,is_convertible:"No",conversion_rate:100});c.useEffect(()=>{B()},[]);const B=async()=>{try{const a=await b.get("/leave-types");if(Array.isArray(a.data)){const r=a.data.map(n=>({...n,pay_rate:parseFloat(n.pay_rate)||0}));C(r)}else console.error("Expected an array of leave types, but received:",a.data)}catch(a){console.error("Error fetching leave types:",a)}},y=a=>{const{name:r,value:n}=a.target,s={...i,[r]:n};r==="type"&&n==="Unpaid"&&(s.pay_rate=0),N(s)},j=a=>{const{name:r,value:n}=a.target,s={...t,[r]:n};r==="type"&&n==="Unpaid"&&(s.pay_rate=0),E(s)},P=a=>a.name.trim()?a.type==="Paid"&&(a.pay_rate<0||a.pay_rate>100)?"Pay rate must be between 0 and 100 for paid leave":"":"Leave type name is required",A=async()=>{var r,n;const a=P(i);if(a){l(a);return}try{const s=await b.post("/leave-types",{...i,pay_rate:i.type==="Unpaid"?0:i.pay_rate});C([...x,s.data]),u(!1),N({name:"",type:"Paid",pay_rate:100}),l("")}catch(s){console.error("Error creating leave type:",s),l(((n=(r=s.response)==null?void 0:r.data)==null?void 0:n.message)||"Failed to create leave type")}},D=async()=>{var r,n;const a=P(t);if(a){l(a);return}try{const s=await b.put(`/leave-types/${t.id}`,{...t,pay_rate:t.type==="Unpaid"?0:t.pay_rate}),z=x.map(w=>w.id===t.id?s.data:w);C(z),f(!1),l("")}catch(s){console.error("Error updating leave type:",s),l(((n=(r=s.response)==null?void 0:r.data)==null?void 0:n.message)||"Failed to update leave type")}},H=async a=>{var r,n;try{await b.delete(`/leave-types/${a}`),C(x.filter(s=>s.id!==a))}catch(s){console.error("Error deleting leave type:",s),l(((n=(r=s.response)==null?void 0:r.data)==null?void 0:n.message)||"Failed to delete leave type")}},I=a=>{E({...a,pay_rate:parseFloat(a.pay_rate)||0}),f(!0),l("")},V=(a,r)=>a==="Unpaid"?"Unpaid":`${r}%`,$=a=>a==="Paid"?"success":"secondary";return e.jsxs(K,{children:[e.jsxs(Q,{className:"d-flex justify-content-between align-items-center flex-wrap",children:[e.jsx("strong",{children:"Leave Type List"}),e.jsx(d,{color:"primary",onClick:()=>u(!0),children:e.jsx(_,{icon:q})})]}),e.jsxs(O,{children:[h&&e.jsx(T,{color:"danger",children:h}),e.jsx("div",{className:"table-responsive",children:e.jsxs(W,{striped:!0,hover:!0,responsive:!0,children:[e.jsx(X,{children:e.jsxs(L,{children:[e.jsx(m,{children:"#"}),e.jsx(m,{children:"Leave Type"}),e.jsx(m,{children:"Type"}),e.jsx(m,{children:"Pay Rate"}),e.jsx(m,{children:"Conversion"}),e.jsx(m,{children:"Actions"})]})}),e.jsx(Z,{children:x.length>0?x.map((a,r)=>e.jsxs(L,{children:[e.jsx(p,{children:r+1}),e.jsx(p,{children:a.name}),e.jsx(p,{children:e.jsx(ee,{color:$(a.type),children:a.type})}),e.jsx(p,{children:V(a.type,a.pay_rate)}),e.jsx(p,{children:a.is_convertible==="Yes"?`Yes (${Math.round(a.conversion_rate)}%)`:"-"}),e.jsxs(p,{children:[e.jsx(d,{color:"info",size:"sm",className:"me-2",onClick:()=>I(a),children:e.jsx(_,{icon:G})}),e.jsx(d,{color:"danger",size:"sm",onClick:()=>H(a.id),children:e.jsx(_,{icon:J})})]})]},a.id)):e.jsx(L,{children:e.jsx(p,{colSpan:"6",className:"text-center",children:"No leave types found."})})})]})})]}),e.jsxs(F,{visible:Y,onClose:()=>u(!1),children:[e.jsx(M,{children:e.jsx(U,{children:"Create New Leave Type"})}),e.jsxs(S,{children:[h&&e.jsx(T,{color:"danger",children:h}),e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{children:"Leave Type Name"}),e.jsx(v,{type:"text",name:"name",value:i.name,onChange:y,placeholder:"Enter leave type name"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{children:"Leave Type"}),e.jsxs(g,{name:"type",value:i.type,onChange:y,children:[e.jsx("option",{value:"Paid",children:"Paid"}),e.jsx("option",{value:"Unpaid",children:"Unpaid"})]})]}),i.type==="Paid"&&e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{children:"Pay Rate (%)"}),e.jsx(v,{type:"number",name:"pay_rate",min:"0",max:"100",value:i.pay_rate,onChange:y,placeholder:"Enter pay rate percentage (0-100)"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{children:"Is Convertible"}),e.jsxs(g,{name:"is_convertible",value:i.is_convertible,onChange:y,children:[e.jsx("option",{value:"Yes",children:"Yes"}),e.jsx("option",{value:"No",children:"No"})]})]}),i.is_convertible==="Yes"&&e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{children:"Conversion Rate (%)"}),e.jsx(v,{type:"number",name:"conversion_rate",min:"0",max:"100",value:i.conversion_rate,onChange:y,placeholder:"Enter conversion rate percentage (0-100)"})]})]}),e.jsxs(R,{children:[e.jsx(d,{color:"secondary",onClick:()=>u(!1),children:"Cancel"}),e.jsx(d,{color:"primary",onClick:A,children:"Create Leave Type"})]})]}),e.jsxs(F,{visible:k,onClose:()=>f(!1),children:[e.jsx(M,{children:e.jsx(U,{children:"Edit Leave Type"})}),e.jsxs(S,{children:[h&&e.jsx(T,{color:"danger",children:h}),e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{children:"Leave Type Name"}),e.jsx(v,{type:"text",name:"name",value:t.name,onChange:j,placeholder:"Enter leave type name"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{children:"Leave Type"}),e.jsxs(g,{name:"type",value:t.type,onChange:j,children:[e.jsx("option",{value:"Paid",children:"Paid"}),e.jsx("option",{value:"Unpaid",children:"Unpaid"})]})]}),t.type==="Paid"&&e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{children:"Pay Rate (%)"}),e.jsx(v,{type:"number",name:"pay_rate",min:"0",max:"100",value:t.pay_rate,onChange:j,placeholder:"Enter pay rate percentage (0-100)"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{children:"Is Convertible"}),e.jsxs(g,{name:"is_convertible",value:t.is_convertible,onChange:j,children:[e.jsx("option",{value:"Yes",children:"Yes"}),e.jsx("option",{value:"No",children:"No"})]})]}),t.is_convertible==="Yes"&&e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{children:"Conversion Rate (%)"}),e.jsx(v,{type:"number",name:"conversion_rate",min:"0",max:"100",value:t.conversion_rate,onChange:j,placeholder:"Enter conversion rate percentage (0-100)"})]})]}),e.jsxs(R,{children:[e.jsx(d,{color:"secondary",onClick:()=>f(!1),children:"Cancel"}),e.jsx(d,{color:"primary",onClick:D,children:"Save Changes"})]})]})]})};export{xe as default};
