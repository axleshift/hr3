import{r as t,_ as D,R as A,a as $,c as B,P as u,l as G,m as p,j as e,C as z}from"./index-B_iLjB0e.js";import{F as I,s as H,f as L,a as w}from"./index-Co_23KSm.js";import{C as O,a as Y}from"./CRow-CJD1Oy9R.js";import{C as q,a as J}from"./CCardBody-2AJILW45.js";import{C as K}from"./CCardHeader-DLU2HqC-.js";import{C as M}from"./CAlert-D69ZgoJV.js";import{C as Q}from"./CForm-DCCbGdtc.js";import{C as y}from"./CInputGroup-CP7Xvey4.js";import{C as b}from"./CInputGroupText-CesxqR25.js";import{C as v}from"./CFormInput-DsFNTbKA.js";import"./CFormControlWrapper-BZGs_UKG.js";var N=t.forwardRef(function(r,f){var a,l=r.align,h=r.className,n=r.fluid,F=r.rounded,x=r.thumbnail,o=D(r,["align","className","fluid","rounded","thumbnail"]);return A.createElement("img",$({className:B((a={},a["float-".concat(l)]=l&&(l==="start"||l==="end"),a["d-block mx-auto"]=l&&l==="center",a["img-fluid"]=n,a.rounded=F,a["img-thumbnail"]=x,a),h)||void 0},o,{ref:f}))});N.propTypes={align:u.oneOf(["start","center","end"]),className:u.string,fluid:u.bool,rounded:u.bool,thumbnail:u.bool};N.displayName="CImage";const ne=()=>{const[r,f]=t.useState(null),[a,l]=t.useState(null),[h,n]=t.useState(!0),[F,x]=t.useState(null),[o,g]=t.useState(!1),[d,S]=t.useState({name:"",username:"",email:""}),[c,m]=t.useState({visible:!1,type:"",message:""}),C=G.get("dcims"),E=t.useRef(null);t.useEffect(()=>{C?p.post("/auth/verify-session",{session_id:C}).then(s=>{f(s.data.user),S({name:s.data.user.name,username:s.data.user.username,email:s.data.user.email}),P(s.data.user.id)}).catch(()=>n(!1)):n(!1)},[C]);const P=s=>{p.get(`/profiles/${s}`).then(i=>{l(i.data.data),n(!1)}).catch(()=>n(!1))},k=s=>{const i=s.target.files[0];i&&(x(i),R(i))},R=s=>{if(!s)return;const i=new FormData;i.append("profile",s),i.append("user_id",r.id),p.post("/profiles",i,{headers:{"Content-Type":"multipart/form-data"}}).then(_=>{l(_.data.data),m({visible:!0,type:"success",message:"Profile picture updated successfully!"})}).catch(()=>{m({visible:!0,type:"danger",message:"Failed to update profile picture."})})},T=()=>E.current.click(),j=s=>S({...d,[s.target.name]:s.target.value}),U=()=>{p.put(`/profiles/${r.id}`,d).then(s=>{m({visible:!0,type:"success",message:"Profile updated successfully!"}),g(!1),f(s.data.user)}).catch(()=>{m({visible:!0,type:"danger",message:"Failed to update profile."})})};return t.useEffect(()=>{if(c.visible){const s=setTimeout(()=>m({...c,visible:!1}),3e3);return()=>clearTimeout(s)}},[c]),h?e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"60vh"},children:e.jsx(z,{color:"primary"})}):r?e.jsx(O,{children:e.jsx(Y,{children:e.jsxs(q,{className:"mb-2",children:[e.jsxs(K,{className:"d-flex justify-content-between align-items-center",children:[e.jsx("strong",{children:"Profile"}),e.jsx(I,{icon:H,className:"text-warning",style:{cursor:"pointer"},onClick:()=>g(!0)})]}),e.jsxs(J,{children:[c.visible&&e.jsx(M,{color:c.type,children:c.message}),e.jsx("div",{className:"text-center mb-4",onClick:T,style:{cursor:"pointer"},children:a!=null&&a.profile_url?e.jsx(N,{src:a.profile_url,className:"rounded-circle",style:{width:"150px",height:"150px"}}):e.jsx("div",{className:"rounded-circle bg-secondary d-flex justify-content-center align-items-center",style:{width:"150px",height:"150px"},children:e.jsx(I,{icon:L,size:"3x",className:"text-light"})})}),e.jsx("input",{type:"file",ref:E,onChange:k,accept:"image/*",style:{display:"none"}}),e.jsxs(Q,{children:[e.jsxs(y,{className:"mb-3",children:[e.jsx(b,{children:"Name"}),e.jsx(v,{type:"text",name:"name",placeholder:"Name",value:d.name,onChange:j,disabled:!o})]}),e.jsxs(y,{className:"mb-3",children:[e.jsx(b,{children:"Username"}),e.jsx(v,{type:"text",name:"username",placeholder:"Username",value:d.username,onChange:j,disabled:!o})]}),e.jsxs(y,{className:"mb-3",children:[e.jsx(b,{children:"Email"}),e.jsx(v,{type:"email",name:"email",placeholder:"Email",value:d.email,onChange:j,disabled:!o})]}),e.jsx("div",{className:"text-center mt-4",children:o&&e.jsxs(e.Fragment,{children:[e.jsx(w,{color:"primary",className:"me-2",onClick:U,children:"Save"}),e.jsx(w,{color:"secondary",onClick:()=>g(!1),children:"Cancel"})]})})]})]})]})})}):e.jsx("div",{children:"You are not authenticated."})};export{ne as default};
