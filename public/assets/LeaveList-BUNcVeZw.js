import{r as c,_ as U,R as n,a as y,c as x,P as l,m as z,j as e,C as $}from"./index-Y44Ldxrt.js";import{u as M,a as G,F as q,w as J,x as K}from"./index-BrEmiYF0.js";import{C as Q,a as W}from"./CCardBody-CBtb8McC.js";import{C as X}from"./CCardHeader-uNRxC_5E.js";import{C as Y}from"./CFormSelect-BS2OFBr_.js";import{C as Z,a as _,b as V,c as o,d as ee,e as u}from"./CTable-Dc7j-tW1.js";import{C as te,a as ae,b as ne,c as re,d as R}from"./DefaultLayout-porhYt5a.js";import{C as I,a as B}from"./CFormControlWrapper-mr0PDOF2.js";var T=c.forwardRef(function(a,w){var j=a.className,s=a.button,m=a.feedback,E=a.feedbackInvalid,C=a.feedbackValid,N=a.floatingLabel,P=a.tooltipFeedback,g=a.hitArea,h=a.id,f=a.indeterminate,t=a.inline,i=a.invalid,r=a.label,p=a.reverse,b=a.type,d=b===void 0?"checkbox":b,F=a.valid,S=U(a,["className","button","feedback","feedbackInvalid","feedbackValid","floatingLabel","tooltipFeedback","hitArea","id","indeterminate","inline","invalid","label","reverse","type","valid"]),v=c.useRef(null),H=M(w,v);c.useEffect(function(){v.current&&f&&(v.current.indeterminate=f)},[f,v.current]);var k=function(){return n.createElement("input",y({type:d,className:x(s?"btn-check":"form-check-input",{"is-invalid":i,"is-valid":F,"me-2":g}),id:h},S,{ref:H}))},D=function(){return n.createElement(B,{describedby:S["aria-describedby"],feedback:m,feedbackInvalid:E,feedbackValid:C,floatingLabel:N,invalid:i,tooltipFeedback:P,valid:F})},A=function(){var L;return n.createElement(I,y({customClassName:x(s?x("btn",s.variant?"btn-".concat(s.variant,"-").concat(s.color):"btn-".concat(s.color),(L={},L["btn-".concat(s.size)]=s.size,L),"".concat(s.shape)):"form-check-label")},h&&{htmlFor:h}),r)},O=function(){return s?n.createElement(n.Fragment,null,n.createElement(k,null),r&&n.createElement(A,null),n.createElement(D,null)):r?g?n.createElement(n.Fragment,null,n.createElement(k,null),n.createElement(I,y({customClassName:x("form-check-label stretched-link",j)},h&&{htmlFor:h}),r),n.createElement(D,null)):n.createElement("div",{className:x("form-check",{"form-check-inline":t,"form-check-reverse":p,"is-invalid":i,"is-valid":F},j)},n.createElement(k,null),n.createElement(A,null),n.createElement(D,null)):n.createElement(k,null)};return n.createElement(O,null)});T.propTypes=y({button:l.object,className:l.string,hitArea:l.oneOf(["full"]),id:l.string,indeterminate:l.bool,inline:l.bool,label:l.oneOfType([l.string,l.node]),reverse:l.bool,type:l.oneOf(["checkbox","radio"])},B.propTypes);T.displayName="CFormCheck";const he=()=>{const[a,w]=c.useState([]),[j,s]=c.useState(!0),[m,E]=c.useState("all"),[C,N]=c.useState(1),[P,g]=c.useState(1);c.useEffect(()=>{h(C)},[C,m]);const h=async(t=1)=>{try{s(!0);const i=await z.get(`/leave-requests?page=${t}`);let r=i.data.leaveRequests||[];const p=new Date,b=new Date(p.getTime()-24*60*60*1e3);m==="last24"?r=r.filter(d=>new Date(d.created_at)>=b):m==="recent"?r=r.filter(d=>new Date(d.created_at)<b&&new Date(d.created_at)>new Date(p.getTime()-7*24*60*60*1e3)):m==="old"&&(r=r.filter(d=>new Date(d.created_at)<=new Date(p.getTime()-7*24*60*60*1e3))),w(r),g(i.data.totalPages)}catch(i){console.error("Error fetching leave list:",i),alert("Failed to fetch leave requests. Please try again later.")}finally{s(!1)}},f=t=>{switch(t.toLowerCase()){case"pending":return"warning";case"approved":return"success";case"rejected":return"danger";default:return"secondary"}};return e.jsxs(Q,{children:[e.jsxs(X,{className:"d-flex justify-content-between align-items-center",children:[e.jsx("strong",{children:"Leave Requests"}),e.jsxs(Y,{value:m,onChange:t=>E(t.target.value),style:{width:"200px"},children:[e.jsx("option",{value:"all",children:"All Requests"}),e.jsx("option",{value:"last24",children:"Last 24 Hours"}),e.jsx("option",{value:"recent",children:"Recent (Last 7 Days)"}),e.jsx("option",{value:"old",children:"Older"})]})]}),e.jsx(W,{children:j?e.jsxs("div",{className:"text-center",children:[e.jsx($,{color:"primary"}),e.jsx("p",{children:"Loading..."})]}):a.length===0?e.jsx("div",{className:"text-center",children:e.jsx("p",{children:"No leave request."})}):e.jsxs(Z,{hover:!0,responsive:!0,children:[e.jsx(_,{children:e.jsxs(V,{children:[e.jsx(o,{children:"#"}),e.jsx(o,{children:"Employee"}),e.jsx(o,{children:"Date Requested"}),e.jsx(o,{children:"Leave Type"}),e.jsx(o,{children:"Days"}),e.jsx(o,{children:"Status"}),e.jsx(o,{children:"Paid"}),e.jsx(o,{children:"Actions"})]})}),e.jsx(ee,{children:a.map((t,i)=>e.jsxs(V,{children:[e.jsx(u,{children:i+1}),e.jsx(u,{children:t.name}),e.jsx(u,{children:new Date(t.created_at).toLocaleDateString()}),e.jsx(u,{children:t.leave_type}),e.jsx(u,{children:t.total_days}),e.jsx(u,{children:e.jsx(te,{color:f(t.status),children:t.status})}),e.jsx(u,{children:e.jsx(T,{id:`paid-checkbox-${t.id}`,checked:t.is_paid,onChange:r=>handlePaidUpdate(t.id,r.target.checked)})}),e.jsxs(u,{children:[e.jsx(G,{color:"link",onClick:()=>handleView(t.id),children:e.jsx(q,{icon:J})}),e.jsxs(ae,{children:[e.jsx(ne,{color:"link",size:"sm",children:e.jsx(q,{icon:K})}),e.jsxs(re,{children:[e.jsx(R,{onClick:()=>handleStatusUpdate(t.id,"Approved"),disabled:t.status==="Approved",children:"Approved"}),e.jsx(R,{onClick:()=>handleStatusUpdate(t.id,"Rejected"),disabled:t.status==="Rejected",children:"Rejected"}),e.jsx(R,{onClick:()=>handleStatusUpdate(t.id,"Pending"),disabled:t.status==="Pending",children:"Pending"})]})]})]})]},t.id))})]})})]})};export{he as default};
