import{r,u as b,a as S,j as e,C as v,L as w,b as N,c as I}from"./index-BtzoJ0Oh.js";import{C as L,F as m,f as _,a as E,b as F}from"./Compliance-D-9-SaG3.js";import{C as u,a as p}from"./CRow-CZaYLmKA.js";import{C as T,a as P}from"./CCardBody-DmyLL-Uc.js";import{C as U}from"./CForm-CL5fVnhx.js";import{C as k}from"./CAlert-DaYrbzOd.js";import{C as x}from"./CInputGroup-DPJzfCVm.js";import{C as h}from"./CInputGroupText-COytgnHc.js";import{C as f}from"./CFormInput-Dsm8XD5N.js";import"./CFormControlWrapper-DVbt2j3a.js";const J=()=>{const[o,g]=r.useState(""),[i,j]=r.useState(""),[n,l]=r.useState(!1),[t,d]=r.useState({visible:!1,type:"",message:""}),c=b(),C=S(),y=async a=>{a.preventDefault(),l(!0);try{const s=await N.post("/auth/login",{username:o,password:i});c({type:"SET_USER",payload:s.data.user}),c({type:"SET_SESSION_ID",payload:s.data.session_id}),I.set("dcims",s.data.session_id,{expires:30}),sessionStorage.setItem("session_id",s.data.session_id),sessionStorage.setItem("role",s.data.user.role),sessionStorage.setItem("user_id",s.data.user.id),sessionStorage.setItem("name",s.data.user.name),C("/dashboard")}catch{d({visible:!0,type:"danger",message:"Login failed. Please check your credentials."})}finally{l(!1)}};return r.useEffect(()=>{if(t.visible){const a=setTimeout(()=>d({...t,visible:!1}),3e3);return()=>clearTimeout(a)}},[t]),e.jsx("div",{className:"bg-light min-vh-100 d-flex flex-row align-items-center justify-content-center",children:e.jsx(L,{children:e.jsx(u,{className:"justify-content-center",children:e.jsx(p,{xs:12,sm:10,md:8,lg:5,children:e.jsx(T,{className:"shadow-sm p-4 border-0 rounded",children:e.jsx(P,{children:e.jsxs(U,{onSubmit:y,children:[e.jsx("h2",{className:"text-left fw-bold",children:"Login"}),e.jsx("p",{className:"text-left text-muted",children:"Sign in to your account"}),t.visible&&e.jsx(k,{color:t.type,className:"mb-3",children:t.message}),e.jsxs(x,{className:"mb-3",children:[e.jsx(h,{children:e.jsx(m,{icon:_})}),e.jsx(f,{type:"text",placeholder:"Username",value:o,onChange:a=>g(a.target.value),required:!0})]}),e.jsxs(x,{className:"mb-3",children:[e.jsx(h,{children:e.jsx(m,{icon:E})}),e.jsx(f,{type:"password",placeholder:"Password",value:i,onChange:a=>j(a.target.value),required:!0})]}),e.jsx(u,{children:e.jsx(p,{children:e.jsx(F,{type:"submit",color:"primary",className:"w-100",disabled:n,children:n?e.jsx(v,{component:"span",size:"sm","aria-hidden":"true"}):"Login"})})}),e.jsx("div",{className:"text-center mt-3",children:e.jsx(w,{to:"/ForgotPassword",className:"text-decoration-none",children:"Forgot password?"})})]})})})})})})})};export{J as default};
