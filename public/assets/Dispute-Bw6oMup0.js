import{r,j as e}from"./index-DLmnIqy-.js";import{a as m}from"./api-DwbPoVFv.js";import{C as k,a as v}from"./CRow-D_sGLWX_.js";import{C as H}from"./CAlert-BZjV-HHH.js";import{C as P,a as U}from"./CCardBody-DfS5_nuD.js";import{C as A}from"./CCardHeader-BhAXpAMg.js";import{C as z,a as G,b as y,c as o,d as I,e as a}from"./CTable-DPZp-y3R.js";import{a as S}from"./DefaultLayout-da0zcv8b.js";import{a as c}from"./index-BzeTyS9E.js";import{C as D,a as _,b as w,c as M}from"./CModalTitle-C2yBrXNe.js";import{C as $,a as l}from"./CListGroupItem-BkaPsGJt.js";import{C as R}from"./CModalFooter-BqkdO2U_.js";import{C as O}from"./CForm-jbt0bXtC.js";import{C as V}from"./CFormSelect-CKgELBJY.js";import{C as q}from"./CFormTextarea-CdW_KHwp.js";import"./index-xsH4HHeE.js";import"./CFormControlWrapper-BnNbabf9.js";const ce=()=>{var b;const[T,E]=r.useState([]),[t,h]=r.useState(null),[p,n]=r.useState(!1),[N,i]=r.useState(!1),[d,u]=r.useState({status:"under_review",resolution_notes:""}),[C,x]=r.useState("");r.useEffect(()=>{f()},[]);const f=async()=>{try{const s=await m.get("/disputes");E(s.data)}catch(s){console.error("Error fetching disputes:",s),x("Failed to load disputes")}},B=s=>{h(s),u({status:s.status,resolution_notes:s.resolution_notes||""}),n(!0)},F=s=>{h(s),u({status:s.status,resolution_notes:s.resolution_notes||""}),i(!0)},L=async()=>{try{if(await m.put(`/disputes/${t.id}`,d),i(!1),f(),p){const s=await m.get(`/disputes/${t.id}`);h(s.data)}}catch(s){console.error("Error updating dispute:",s),x("Failed to update dispute")}},g=s=>({submitted:"warning",under_review:"info",resolved:"success",rejected:"danger"})[s]||"secondary";return e.jsxs(k,{children:[C&&e.jsx(v,{xs:12,children:e.jsx(H,{color:"danger",onClose:()=>x(""),dismissible:!0,children:C})}),e.jsx(v,{xs:12,children:e.jsxs(P,{className:"mb-4",children:[e.jsx(A,{children:e.jsx("strong",{children:"Disputes"})}),e.jsx(U,{children:e.jsxs(z,{striped:!0,hover:!0,responsive:!0,children:[e.jsx(G,{children:e.jsxs(y,{children:[e.jsx(o,{children:"ID"}),e.jsx(o,{children:"Employee"}),e.jsx(o,{children:"Type"}),e.jsx(o,{children:"Pay Period"}),e.jsx(o,{children:"Status"}),e.jsx(o,{children:"Submitted"}),e.jsx(o,{children:"Actions"})]})}),e.jsx(I,{children:T.map(s=>{var j;return e.jsxs(y,{children:[e.jsx(a,{children:s.id}),e.jsx(a,{children:(j=s.user)==null?void 0:j.name}),e.jsx(a,{children:s.type}),e.jsx(a,{children:new Date(s.pay_period).toLocaleDateString()}),e.jsx(a,{children:e.jsx(S,{color:g(s.status),children:s.status.replace("_"," ")})}),e.jsx(a,{children:new Date(s.created_at).toLocaleDateString()}),e.jsx(a,{children:e.jsx(c,{color:"primary",size:"sm",onClick:()=>B(s),children:"Manage"})})]},s.id)})})]})})]})}),e.jsxs(D,{size:"lg",visible:p,onClose:()=>n(!1),children:[e.jsx(_,{onClose:()=>n(!1),children:e.jsxs(w,{children:["Dispute Details",e.jsx(S,{color:g(t==null?void 0:t.status),className:"ms-2",children:t==null?void 0:t.status.replace("_"," ")})]})}),e.jsx(M,{children:t&&e.jsxs($,{children:[e.jsxs(l,{children:[e.jsx("strong",{children:"Employee:"})," ",(b=t.user)==null?void 0:b.name]}),e.jsxs(l,{children:[e.jsx("strong",{children:"Type:"})," ",t.type]}),e.jsxs(l,{children:[e.jsx("strong",{children:"Pay Period:"})," ",new Date(t.pay_period).toLocaleDateString()]}),e.jsxs(l,{children:[e.jsx("strong",{children:"Submitted:"})," ",new Date(t.created_at).toLocaleString()]}),e.jsxs(l,{children:[e.jsx("strong",{children:"Description:"}),e.jsx("div",{className:"mt-2 p-2 bg-light rounded",children:t.description})]}),t.resolution_notes&&e.jsxs(l,{children:[e.jsx("strong",{children:"Resolution Notes:"}),e.jsx("div",{className:"mt-2 p-2 bg-light rounded",children:t.resolution_notes})]})]})}),e.jsxs(R,{children:[e.jsx(c,{color:"secondary",onClick:()=>n(!1),children:"Close"}),t&&e.jsx(c,{color:"primary",onClick:()=>{n(!1),F(t)},children:"Update Status"})]})]}),e.jsxs(D,{visible:N,onClose:()=>i(!1),children:[e.jsx(_,{onClose:()=>i(!1),children:e.jsx(w,{children:"Update Dispute Status"})}),e.jsxs(O,{onSubmit:s=>{s.preventDefault(),L()},children:[e.jsxs(M,{children:[e.jsx("div",{className:"mb-3",children:e.jsx(V,{label:"Status",value:d.status,onChange:s=>u({...d,status:s.target.value}),options:[{label:"Submitted",value:"submitted"},{label:"Under Review",value:"under_review"},{label:"Resolved",value:"resolved"},{label:"Rejected",value:"rejected"}]})}),e.jsx("div",{className:"mb-3",children:e.jsx(q,{label:"Resolution Notes",value:d.resolution_notes,onChange:s=>u({...d,resolution_notes:s.target.value}),rows:5})})]}),e.jsxs(R,{children:[e.jsx(c,{color:"secondary",onClick:()=>i(!1),children:"Cancel"}),e.jsx(c,{color:"primary",type:"submit",children:"Update"})]})]})]})]})};export{ce as default};
