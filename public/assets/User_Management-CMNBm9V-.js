import{r as i,j as e,C as j,P as s}from"./index-DH84xEMy.js";import{b as y,F as b,D as N,a as p}from"./index-CWfMdjxT.js";import{a as v}from"./api-b5EB9aEo.js";import{C as S,a as w}from"./CRow-KS5x1aC8.js";import{C as k,a as T}from"./CCardBody-BiYWHczo.js";import{C as A}from"./CCardHeader-BKJnbTPA.js";import{C as F}from"./CForm-CTCmgsTH.js";import{C as R}from"./CAlert-c1ydVGHq.js";import{C as q}from"./CInputGroup-B-o5lMH9.js";import{C as B}from"./CInputGroupText-C2R2qtBm.js";import{C as I}from"./CFormInput-BNOGNQbV.js";import"./index-xsH4HHeE.js";import"./CFormControlWrapper-tX4rBDMg.js";const V=({email:o,tempSession:x,onSuccess:h,onBack:u})=>{const[n,f]=i.useState(""),[l,c]=i.useState(!1),[t,C]=i.useState({visible:!1,type:"",message:""}),g=async r=>{var m,d;r.preventDefault(),c(!0);try{const a=await v.post("/auth/verify-2fa",{email:o,token:n,temp_session:x});h(a.data)}catch(a){C({visible:!0,type:"danger",message:((d=(m=a.response)==null?void 0:m.data)==null?void 0:d.message)||"Verification failed. Please try again."})}finally{c(!1)}};return e.jsx("div",{className:"bg-light min-vh-100 d-flex flex-row align-items-center",children:e.jsx(y,{children:e.jsx(S,{className:"justify-content-center",children:e.jsx(w,{xs:12,sm:10,md:8,lg:5,children:e.jsxs(k,{className:"border-0 shadow-sm",children:[e.jsx(A,{className:"bg-white border-0 text-center py-4",children:e.jsx("h3",{className:"mb-0",children:"2-Step Verification"})}),e.jsxs(T,{className:"p-4",children:[e.jsxs("p",{className:"text-muted text-center mb-4",children:["This extra step shows its really you trying to sign in",e.jsx("br",{}),e.jsx("strong",{children:o})]}),e.jsxs(F,{onSubmit:g,children:[e.jsx("h5",{className:"text-center mb-3",children:"Enter your verification code"}),t.visible&&e.jsx(R,{color:t.type,className:"mb-3",children:t.message}),e.jsxs(q,{className:"mb-4",children:[e.jsx(B,{children:e.jsx(b,{icon:N})}),e.jsx(I,{type:"text",placeholder:"6-digit code",value:n,onChange:r=>f(r.target.value.replace(/\D/g,"").slice(0,6)),maxLength:6,required:!0,className:"text-center"})]}),e.jsxs("div",{className:"d-grid gap-2",children:[e.jsx(p,{color:"primary",type:"submit",disabled:l,className:"py-2",children:l?e.jsx(j,{size:"sm"}):"Verify"}),e.jsx(p,{color:"link",onClick:u,className:"text-muted",children:"Back to sign in"})]})]})]})]})})})})})};V.propTypes={email:s.string.isRequired,tempSession:s.string,onSuccess:s.func.isRequired,onBack:s.func.isRequired};export{V as default};
