import{r as d,m as g,j as e}from"./index-DPw8gujG.js";import{a as c,F as b,r as G,s as J,t as K}from"./index-C6IL73NQ.js";import{C as O,a as Q}from"./CCardBody-B_tImLmD.js";import{C as W}from"./CCardHeader-B-D2uoQY.js";import{C as T}from"./CAlert-CdiLQgLx.js";import{C as X,a as Y,b as _,c as h,d as Z,e as p}from"./CTable-2gP5Af63.js";import{C as ee}from"./DefaultLayout-DyfB1xHN.js";import{C as w,a as F,b as U,c as M}from"./CModalTitle-Cu5wGtYg.js";import{C as o}from"./CFormControlWrapper-Mr3y5RG-.js";import{C as m}from"./CFormInput-qOImCO0-.js";import{C as R}from"./CFormSelect-CjNSZl2o.js";import{C as S}from"./CModalFooter-CAEJ9O7Q.js";const he=()=>{const[x,j]=d.useState([]),[k,v]=d.useState(!1),[B,u]=d.useState(!1),[y,n]=d.useState(""),[i,E]=d.useState({name:"",type:"Paid",pay_rate:100,eligibility_rules:""}),[l,L]=d.useState({id:null,name:"",type:"Paid",pay_rate:100,eligibility_rules:""});d.useEffect(()=>{A()},[]);const A=async()=>{try{const a=await g.get("/leave-types");if(Array.isArray(a.data)){const r=a.data.map(t=>({...t,pay_rate:parseFloat(t.pay_rate)||0}));j(r)}else console.error("Expected an array of leave types, but received:",a.data)}catch(a){console.error("Error fetching leave types:",a)}},C=a=>{const{name:r,value:t}=a.target,s={...i,[r]:t};r==="type"&&t==="Unpaid"&&(s.pay_rate=0),E(s)},f=a=>{const{name:r,value:t}=a.target,s={...l,[r]:t};r==="type"&&t==="Unpaid"&&(s.pay_rate=0),L(s)},N=a=>a.name.trim()?a.type==="Paid"&&(a.pay_rate<0||a.pay_rate>100)?"Pay rate must be between 0 and 100 for paid leave":"":"Leave type name is required",D=async()=>{var r,t;const a=N(i);if(a){n(a);return}try{const s=await g.post("/leave-types",{...i,pay_rate:i.type==="Unpaid"?0:i.pay_rate});j([...x,s.data]),v(!1),E({name:"",type:"Paid",pay_rate:100}),n("")}catch(s){console.error("Error creating leave type:",s),n(((t=(r=s.response)==null?void 0:r.data)==null?void 0:t.message)||"Failed to create leave type")}},H=async()=>{var r,t;const a=N(l);if(a){n(a);return}try{const s=await g.put(`/leave-types/${l.id}`,{...l,pay_rate:l.type==="Unpaid"?0:l.pay_rate}),q=x.map(P=>P.id===l.id?s.data:P);j(q),u(!1),n("")}catch(s){console.error("Error updating leave type:",s),n(((t=(r=s.response)==null?void 0:r.data)==null?void 0:t.message)||"Failed to update leave type")}},V=async a=>{var r,t;try{await g.delete(`/leave-types/${a}`),j(x.filter(s=>s.id!==a))}catch(s){console.error("Error deleting leave type:",s),n(((t=(r=s.response)==null?void 0:r.data)==null?void 0:t.message)||"Failed to delete leave type")}},$=a=>{L({...a,pay_rate:parseFloat(a.pay_rate)||0}),u(!0),n("")},z=(a,r)=>a==="Unpaid"?"Unpaid":`${r}%`,I=a=>a==="Paid"?"success":"secondary";return e.jsxs(O,{children:[e.jsxs(W,{className:"d-flex justify-content-between align-items-center flex-wrap",children:[e.jsx("strong",{children:"Leave Type List"}),e.jsx(c,{color:"primary",onClick:()=>v(!0),children:e.jsx(b,{icon:G})})]}),e.jsxs(Q,{children:[y&&e.jsx(T,{color:"danger",children:y}),e.jsx("div",{className:"table-responsive",children:e.jsxs(X,{striped:!0,hover:!0,responsive:!0,children:[e.jsx(Y,{children:e.jsxs(_,{children:[e.jsx(h,{children:"#"}),e.jsx(h,{children:"Leave Type"}),e.jsx(h,{children:"Type"}),e.jsx(h,{children:"Pay Rate"}),e.jsx(h,{children:"Rules"}),e.jsx(h,{children:"Actions"})]})}),e.jsx(Z,{children:x.length>0?x.map((a,r)=>e.jsxs(_,{children:[e.jsx(p,{children:r+1}),e.jsx(p,{children:a.name}),e.jsx(p,{children:e.jsx(ee,{color:I(a.type),children:a.type})}),e.jsx(p,{children:z(a.type,a.pay_rate)}),e.jsx(p,{children:a.eligibility_rules}),e.jsxs(p,{children:[e.jsx(c,{color:"info",size:"sm",className:"me-2",onClick:()=>$(a),children:e.jsx(b,{icon:J})}),e.jsx(c,{color:"danger",size:"sm",onClick:()=>V(a.id),children:e.jsx(b,{icon:K})})]})]},a.id)):e.jsx(_,{children:e.jsx(p,{colSpan:"6",className:"text-center",children:"No leave types found."})})})]})})]}),e.jsxs(w,{visible:k,onClose:()=>v(!1),children:[e.jsx(F,{children:e.jsx(U,{children:"Create New Leave Type"})}),e.jsxs(M,{children:[y&&e.jsx(T,{color:"danger",children:y}),e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{children:"Leave Type Name"}),e.jsx(m,{type:"text",name:"name",value:i.name,onChange:C,placeholder:"Enter leave type name"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{children:"Leave Type"}),e.jsxs(R,{name:"type",value:i.type,onChange:C,children:[e.jsx("option",{value:"Paid",children:"Paid"}),e.jsx("option",{value:"Unpaid",children:"Unpaid"})]})]}),i.type==="Paid"&&e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{children:"Pay Rate (%)"}),e.jsx(m,{type:"number",name:"pay_rate",min:"0",max:"100",value:i.pay_rate,onChange:C,placeholder:"Enter pay rate percentage (0-100)"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{children:"Eligibility Rules"}),e.jsx(m,{type:"text",name:"eligibility_rules",value:i.eligibility_rules,onChange:C,placeholder:"Enter eligibility rules"})]})]}),e.jsxs(S,{children:[e.jsx(c,{color:"secondary",onClick:()=>v(!1),children:"Cancel"}),e.jsx(c,{color:"primary",onClick:D,children:"Create Leave Type"})]})]}),e.jsxs(w,{visible:B,onClose:()=>u(!1),children:[e.jsx(F,{children:e.jsx(U,{children:"Edit Leave Type"})}),e.jsxs(M,{children:[y&&e.jsx(T,{color:"danger",children:y}),e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{children:"Leave Type Name"}),e.jsx(m,{type:"text",name:"name",value:l.name,onChange:f,placeholder:"Enter leave type name"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{children:"Leave Type"}),e.jsxs(R,{name:"type",value:l.type,onChange:f,children:[e.jsx("option",{value:"Paid",children:"Paid"}),e.jsx("option",{value:"Unpaid",children:"Unpaid"})]})]}),l.type==="Paid"&&e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{children:"Pay Rate (%)"}),e.jsx(m,{type:"number",name:"pay_rate",min:"0",max:"100",value:l.pay_rate,onChange:f,placeholder:"Enter pay rate percentage (0-100)"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{children:"Eligibility Rules"}),e.jsx(m,{type:"text",name:"eligibility_rules",value:l.eligibility_rules,onChange:f,placeholder:"Enter eligibility rules"})]})]}),e.jsxs(S,{children:[e.jsx(c,{color:"secondary",onClick:()=>u(!1),children:"Cancel"}),e.jsx(c,{color:"primary",onClick:H,children:"Save Changes"})]})]})]})};export{he as default};
