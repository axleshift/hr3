import{r as t,j as e,C as A,a as F}from"./index-B1cYRwuN.js";import{C as H,a as N}from"./CCardBody-DiDY8RMx.js";import{C as O}from"./CCardHeader-CD8D4PQY.js";import{C as b}from"./CFormSelect-D_ecDevQ.js";import{C as U,a as x}from"./CRow-Cjz99oC5.js";import{C as M}from"./CAlert-tQDp2MAV.js";import{b as Y}from"./Compliance-DPMZF7rg.js";import{C as B,a as R,b as y,c as r,d as k,e as l}from"./CTable-RpRI7F68.js";import{C as w}from"./DefaultLayout-DthfV9Qz.js";import"./CFormControlWrapper-SssR6G-t.js";const V=()=>{var C;const[h,j]=t.useState([]),[E,p]=t.useState(!0),[c,S]=t.useState(new Date().getMonth()+1),[i,_]=t.useState(new Date().getFullYear()),[u,v]=t.useState(null),[m,D]=t.useState({totalEmployees:0,totalOvertime:0,totalUndertime:0}),g=async()=>{var s,a;try{p(!0),v(null);const n=(await F.get("/attendances",{params:{year:i,month:c}})).data;j(Array.isArray(n.employees)?n.employees:[]),n.stats&&D({totalEmployees:n.stats.totalEmployees||0,totalOvertime:n.stats.totalOvertime||0,totalUndertime:n.stats.totalUndertime||0})}catch(o){console.error("Error fetching attendance data:",o),v(((a=(s=o.response)==null?void 0:s.data)==null?void 0:a.message)||"Failed to fetch attendance data"),j([])}finally{p(!1)}};t.useEffect(()=>{g()},[i,c]);const T=t.useMemo(()=>{const s=new Date().getFullYear();return Array.from({length:s-2020+1},(a,o)=>2020+o)},[]),f=t.useMemo(()=>Array.from({length:12},(s,a)=>({value:a+1,label:new Date(2023,a).toLocaleString("default",{month:"long"})})),[]),d=s=>parseFloat(s||0).toFixed(2);return e.jsx("div",{className:"attendances-container",children:e.jsxs(H,{children:[e.jsxs(O,{className:"d-flex justify-content-between align-items-center flex-wrap",children:[e.jsxs("div",{className:"mb-2 mb-md-0",children:[e.jsx("strong",{children:"Employee Attendance"}),e.jsxs("span",{className:"ms-3 text-muted",children:[(C=f.find(s=>s.value===c))==null?void 0:C.label," ",i]})]}),e.jsxs("div",{className:"d-flex flex-wrap gap-2",children:[e.jsx(b,{value:c,onChange:s=>S(parseInt(s.target.value)),className:"form-select-sm",style:{width:"150px"},children:f.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))}),e.jsx(b,{value:i,onChange:s=>_(parseInt(s.target.value)),className:"form-select-sm",style:{width:"120px"},children:T.map(s=>e.jsx("option",{value:s,children:s},s))})]})]}),e.jsx(N,{className:"py-2",children:e.jsxs(U,{className:"g-3",children:[e.jsx(x,{xs:12,md:4,children:e.jsxs("div",{className:"p-3 border rounded bg-light",children:[e.jsx("div",{className:"text-muted small",children:"Total Employees"}),e.jsx("div",{className:"h4 mb-0",children:m.totalEmployees})]})}),e.jsx(x,{xs:12,md:4,children:e.jsxs("div",{className:"p-3 border rounded bg-light",children:[e.jsx("div",{className:"text-muted small",children:"Total Overtime Hours"}),e.jsx("div",{className:"h4 mb-0 text-warning",children:d(m.totalOvertime)})]})}),e.jsx(x,{xs:12,md:4,children:e.jsxs("div",{className:"p-3 border rounded bg-light",children:[e.jsx("div",{className:"text-muted small",children:"Total Undertime Hours"}),e.jsx("div",{className:"h4 mb-0 text-danger",children:d(m.totalUndertime)})]})})]})}),e.jsx(N,{children:E?e.jsxs("div",{className:"text-center py-5",children:[e.jsx(A,{color:"primary"}),e.jsx("p",{className:"mt-2",children:"Loading attendance data..."})]}):u?e.jsxs(M,{color:"danger",className:"text-center",children:[u,e.jsx(Y,{color:"link",size:"sm",onClick:g,className:"ms-2",children:"Retry"})]}):h.length===0?e.jsx("div",{className:"text-center py-5",children:e.jsx("p",{children:"No attendance records found for the selected period."})}):e.jsx("div",{className:"table-responsive",children:e.jsxs(B,{striped:!0,hover:!0,responsive:!0,children:[e.jsx(R,{children:e.jsxs(y,{children:[e.jsx(r,{children:"#"}),e.jsx(r,{children:"Employee"}),e.jsx(r,{children:"Department"}),e.jsx(r,{children:"Position"}),e.jsx(r,{className:"text-end",children:"Work Days"}),e.jsx(r,{className:"text-end",children:"Overtime"}),e.jsx(r,{className:"text-end",children:"Undertime"})]})}),e.jsx(k,{children:h.map((s,a)=>e.jsxs(y,{children:[e.jsx(l,{children:a+1}),e.jsxs(l,{children:[e.jsx("div",{className:"fw-semibold",children:s.name}),e.jsxs("div",{className:"small text-muted",children:["ID: ",s.employee_id]})]}),e.jsx(l,{children:s.department}),e.jsx(l,{children:s.job_position}),e.jsx(l,{className:"text-end",children:d(s.total_regular_hours)}),e.jsx(l,{className:"text-end",children:e.jsx(w,{color:"warning",children:d(s.total_overtime_hours)})}),e.jsx(l,{className:"text-end",children:e.jsx(w,{color:"danger",children:d(s.total_undertime_hours)})})]},s.employee_id))})]})})})]})})};export{V as default};
