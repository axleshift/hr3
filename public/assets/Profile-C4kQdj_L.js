import{r as t,c as D,b as d,j as e,C as R}from"./index-BtzoJ0Oh.js";import{F as b,e as T,f as _,b as N}from"./Compliance-D-9-SaG3.js";import{C as A,a as $}from"./CRow-CZaYLmKA.js";import{C as B,a as G}from"./CCardBody-DmyLL-Uc.js";import{C as z}from"./CCardHeader-DVaNR2J1.js";import{C as H}from"./CAlert-DaYrbzOd.js";import{e as L}from"./DefaultLayout-x30pSXRo.js";import{C as Y}from"./CForm-CL5fVnhx.js";import{C as h}from"./CInputGroup-DPJzfCVm.js";import{C as x}from"./CInputGroupText-COytgnHc.js";import{C}from"./CFormInput-Dsm8XD5N.js";import"./CFormControlWrapper-DVbt2j3a.js";const ae=()=>{const[m,g]=t.useState(null),[n,j]=t.useState(null),[F,c]=t.useState(!0),[q,S]=t.useState(null),[o,u]=t.useState(!1),[i,y]=t.useState({name:"",username:"",email:""}),[r,l]=t.useState({visible:!1,type:"",message:""}),p=D.get("dcims"),v=t.useRef(null);t.useEffect(()=>{p?d.post("/auth/verify-session",{session_id:p}).then(s=>{g(s.data.user),y({name:s.data.user.name,username:s.data.user.username,email:s.data.user.email}),E(s.data.user.id)}).catch(()=>c(!1)):c(!1)},[p]);const E=s=>{d.get(`/profiles/${s}`).then(a=>{j(a.data.data),c(!1)}).catch(()=>c(!1))},I=s=>{const a=s.target.files[0];a&&(S(a),w(a))},w=s=>{if(!s)return;const a=new FormData;a.append("profile",s),a.append("user_id",m.id),d.post("/profiles",a,{headers:{"Content-Type":"multipart/form-data"}}).then(U=>{j(U.data.data),l({visible:!0,type:"success",message:"Profile picture updated successfully!"})}).catch(()=>{l({visible:!0,type:"danger",message:"Failed to update profile picture."})})},k=()=>v.current.click(),f=s=>y({...i,[s.target.name]:s.target.value}),P=()=>{d.put(`/profiles/${m.id}`,i).then(s=>{l({visible:!0,type:"success",message:"Profile updated successfully!"}),u(!1),g(s.data.user)}).catch(()=>{l({visible:!0,type:"danger",message:"Failed to update profile."})})};return t.useEffect(()=>{if(r.visible){const s=setTimeout(()=>l({...r,visible:!1}),3e3);return()=>clearTimeout(s)}},[r]),F?e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"60vh"},children:e.jsx(R,{color:"primary"})}):m?e.jsx(A,{children:e.jsx($,{children:e.jsxs(B,{className:"mb-2",children:[e.jsxs(z,{className:"d-flex justify-content-between align-items-center",children:[e.jsx("strong",{children:"Profile"}),e.jsx(b,{icon:T,className:"text-warning",style:{cursor:"pointer"},onClick:()=>u(!0)})]}),e.jsxs(G,{children:[r.visible&&e.jsx(H,{color:r.type,children:r.message}),e.jsx("div",{className:"text-center mb-4",onClick:k,style:{cursor:"pointer"},children:n!=null&&n.profile_url?e.jsx(L,{src:n.profile_url,className:"rounded-circle",style:{width:"150px",height:"150px"}}):e.jsx("div",{className:"rounded-circle bg-secondary d-flex justify-content-center align-items-center",style:{width:"150px",height:"150px"},children:e.jsx(b,{icon:_,size:"3x",className:"text-light"})})}),e.jsx("input",{type:"file",ref:v,onChange:I,accept:"image/*",style:{display:"none"}}),e.jsxs(Y,{children:[e.jsxs(h,{className:"mb-3",children:[e.jsx(x,{children:"Name"}),e.jsx(C,{type:"text",name:"name",placeholder:"Name",value:i.name,onChange:f,disabled:!o})]}),e.jsxs(h,{className:"mb-3",children:[e.jsx(x,{children:"Username"}),e.jsx(C,{type:"text",name:"username",placeholder:"Username",value:i.username,onChange:f,disabled:!o})]}),e.jsxs(h,{className:"mb-3",children:[e.jsx(x,{children:"Email"}),e.jsx(C,{type:"email",name:"email",placeholder:"Email",value:i.email,onChange:f,disabled:!o})]}),e.jsx("div",{className:"text-center mt-4",children:o&&e.jsxs(e.Fragment,{children:[e.jsx(N,{color:"primary",className:"me-2",onClick:P,children:"Save"}),e.jsx(N,{color:"secondary",onClick:()=>u(!1),children:"Cancel"})]})})]})]})]})})}):e.jsx("div",{children:"You are not authenticated."})};export{ae as default};
