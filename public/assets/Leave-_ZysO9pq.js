import{r as n,i as R,z as N,j as e,m as _}from"./index-Y44Ldxrt.js";import{C as q,a as u}from"./CRow-BZ_9_XYM.js";import{C as w,a as B}from"./CCardBody-CBtb8McC.js";import{C as k}from"./CCardHeader-uNRxC_5E.js";import{a as A,C as I}from"./CForm-qMLrmxec.js";import{C as V}from"./CFormSelect-BS2OFBr_.js";import{C as v}from"./CFormInput-CAbFzxsM.js";import{C as M}from"./CFormTextarea-CV3cfOYL.js";import{a as O}from"./index-BrEmiYF0.js";import"./CFormControlWrapper-mr0PDOF2.js";const Y=()=>{const[p,x]=n.useState(""),[l,j]=n.useState(""),[d,h]=n.useState(""),[c,g]=n.useState(""),[y,f]=n.useState(null),[s,C]=n.useState({}),[i,m]=n.useState({visible:!1,type:"",message:""});R();const E=N(),b={employee_id:sessionStorage.getItem("employee_id")||"",name:sessionStorage.getItem("name")||""},T=a=>{const t=a.target.files[0];t&&f(t)},F=async a=>{var D,S,L;a.preventDefault();const t={};if(p.trim()||(t.leaveType="Leave Type is required"),l.trim()||(t.startDate="Start Date is required"),d.trim()?new Date(l)>new Date(d)&&(t.endDate="End Date must be after Start Date"):t.endDate="End Date is required",c.trim()||(t.reason="Reason is required"),Object.keys(t).length>0){C(t);return}C({});const r=new FormData;r.append("employee_id",b.employee_id),r.append("name",b.name),r.append("leave_type",p),r.append("start_date",l),r.append("end_date",d),r.append("reason",c),y&&r.append("document",y);try{const o=await _.post("/leave-request",r,{headers:{"Content-Type":"multipart/form-data"}});console.log("Response:",o.data),m({visible:!0,type:"success",message:"Leave request submitted successfully!"}),x(""),j(""),h(""),g(""),f(null)}catch(o){console.error("Error Response:",(D=o.response)==null?void 0:D.data),m({visible:!0,type:"danger",message:(L=(S=o.response)==null?void 0:S.data)!=null&&L.errors?Object.values(o.response.data.errors).flat().join(" "):"Failed to submit leave request."})}};return n.useEffect(()=>{if(i.visible){const a=setTimeout(()=>m({...i,visible:!1}),3e3);return()=>clearTimeout(a)}},[i]),E==="loading"?e.jsx("div",{children:"Loading..."}):e.jsx(q,{children:e.jsx(u,{xs:12,children:e.jsxs(w,{children:[e.jsx(k,{children:e.jsx("strong",{children:"Leave Request"})}),e.jsxs(B,{children:[i.visible&&e.jsx(A,{color:i.type,dismissible:!0,children:i.message}),e.jsxs(I,{onSubmit:F,children:[e.jsxs(V,{label:"Leave Type",value:p,onChange:a=>x(a.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Select Leave Type"}),e.jsx("option",{value:"Sick Leave",children:"Sick Leave"}),e.jsx("option",{value:"Vacation Leave",children:"Vacation Leave"}),e.jsx("option",{value:"Emergency Leave",children:"Emergency Leave"}),e.jsx("option",{value:"Maternity Leave",children:"Maternity Leave"}),e.jsx("option",{value:"Calamity Leave",children:"Calamity Leave"}),e.jsx("option",{value:"Bereavement Leave",children:"Bereavement Leave"})]}),s.leaveType&&e.jsx("span",{className:"text-danger",children:s.leaveType}),e.jsx("br",{}),e.jsxs(q,{children:[e.jsxs(u,{className:"mb-3",children:[e.jsx(v,{type:"date",label:"Start Date",value:l,onChange:a=>j(a.target.value),required:!0}),s.startDate&&e.jsx("span",{className:"text-danger",children:s.startDate})]}),e.jsxs(u,{className:"mb-3",children:[e.jsx(v,{type:"date",label:"End Date",value:d,onChange:a=>h(a.target.value),required:!0}),s.endDate&&e.jsx("span",{className:"text-danger",children:s.endDate})]})]}),e.jsx(M,{label:"Reason",value:c,onChange:a=>g(a.target.value),required:!0}),s.reason&&e.jsx("span",{className:"text-danger",children:s.reason}),e.jsx("br",{}),e.jsx(v,{type:"file",label:"Upload Document",onChange:T,accept:"image/*,.pdf,.doc,.docx,.txt,.jpg,.png,.jpeg"}),e.jsx("br",{}),e.jsx(O,{type:"submit",color:"primary",children:"Submit Request"})]})]})]})})})};export{Y as default};
