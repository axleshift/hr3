import{r as c,_ as G,R as s,f as w,g,P as i,b as B,j as e,C as Q}from"./index-BtzoJ0Oh.js";import{u as M,F as A,r as J,b as K,k as U,l as W}from"./Compliance-D-9-SaG3.js";import{C as X,a as Y}from"./CCardBody-DmyLL-Uc.js";import{C as Z}from"./CCardHeader-DVaNR2J1.js";import{C as _}from"./CInputGroup-DPJzfCVm.js";import{C as ee}from"./CFormInput-Dsm8XD5N.js";import{C as te}from"./CInputGroupText-COytgnHc.js";import{C as ae}from"./CFormSelect-BCQr5QGo.js";import{C as re,a as se,b as H,c as o,d as ne,e as d}from"./CTable-D3SISQk6.js";import{C as le,a as ie,b as ce,c as oe,d as D}from"./DefaultLayout-x30pSXRo.js";import{C as O,b as z}from"./CFormControlWrapper-DVbt2j3a.js";import{C as de,a as I}from"./CPaginationItem-Y_DNQVmc.js";var q=c.forwardRef(function(a,j){var C=a.className,n=a.button,R=a.feedback,k=a.feedbackInvalid,y=a.feedbackValid,S=a.floatingLabel,N=a.tooltipFeedback,F=a.hitArea,l=a.id,u=a.indeterminate,E=a.inline,f=a.invalid,m=a.label,L=a.reverse,x=a.type,T=x===void 0?"checkbox":x,v=a.valid,t=G(a,["className","button","feedback","feedbackInvalid","feedbackValid","floatingLabel","tooltipFeedback","hitArea","id","indeterminate","inline","invalid","label","reverse","type","valid"]),r=c.useRef(null),b=M(j,r);c.useEffect(function(){r.current&&u&&(r.current.indeterminate=u)},[u,r.current]);var h=function(){return s.createElement("input",w({type:T,className:g(n?"btn-check":"form-check-input",{"is-invalid":f,"is-valid":v,"me-2":F}),id:l},t,{ref:b}))},p=function(){return s.createElement(z,{describedby:t["aria-describedby"],feedback:R,feedbackInvalid:k,feedbackValid:y,floatingLabel:S,invalid:f,tooltipFeedback:N,valid:v})},V=function(){var P;return s.createElement(O,w({customClassName:g(n?g("btn",n.variant?"btn-".concat(n.variant,"-").concat(n.color):"btn-".concat(n.color),(P={},P["btn-".concat(n.size)]=n.size,P),"".concat(n.shape)):"form-check-label")},l&&{htmlFor:l}),m)},$=function(){return n?s.createElement(s.Fragment,null,s.createElement(h,null),m&&s.createElement(V,null),s.createElement(p,null)):m?F?s.createElement(s.Fragment,null,s.createElement(h,null),s.createElement(O,w({customClassName:g("form-check-label stretched-link",C)},l&&{htmlFor:l}),m),s.createElement(p,null)):s.createElement("div",{className:g("form-check",{"form-check-inline":E,"form-check-reverse":L,"is-invalid":f,"is-valid":v},C)},s.createElement(h,null),s.createElement(V,null),s.createElement(p,null)):s.createElement(h,null)};return s.createElement($,null)});q.propTypes=w({button:i.object,className:i.string,hitArea:i.oneOf(["full"]),id:i.string,indeterminate:i.bool,inline:i.bool,label:i.oneOfType([i.string,i.node]),reverse:i.bool,type:i.oneOf(["checkbox","radio"])},z.propTypes);q.displayName="CFormCheck";const ye=()=>{const[a,j]=c.useState([]),[C,n]=c.useState([]),[R,k]=c.useState(!0),[y,S]=c.useState("all"),[N,F]=c.useState(""),[l,u]=c.useState(1),[E,f]=c.useState(1),m=10;c.useEffect(()=>{L()},[y,l]);const L=async()=>{try{k(!0);const r=(await B.get("/leave-requests/page",{params:{page:l,limit:m}})).data||{};Array.isArray(r.leaveRequests)?(j(r.leaveRequests),n(r.leaveRequests)):(j([]),n([])),f(r.totalPages||1)}catch(t){console.error("Error fetching leave list:",t),j([]),n([]),f(1)}finally{k(!1)}},x=async(t,r)=>{var b,h;try{await B.put(`/leave-requests/${t}`,{status:r}),L()}catch(p){console.error("Error updating leave status:",p),alert(`Failed to update leave status: ${((h=(b=p.response)==null?void 0:b.data)==null?void 0:h.message)||p.message}`)}},T=t=>{if(F(t),t.trim()==="")n(a);else{const r=a.filter(b=>b.name.toLowerCase().includes(t.trim().toLowerCase()));n(r)}},v=t=>{switch(t.toLowerCase()){case"pending":return"warning";case"approved":return"success";case"rejected":return"danger";default:return"secondary"}};return e.jsxs(X,{children:[e.jsxs(Z,{className:"d-flex justify-content-between align-items-center",children:[e.jsx("strong",{children:"Leave Requests"}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsxs(_,{style:{width:"200px"},children:[e.jsx(ee,{type:"text",placeholder:"Search...",value:N,onChange:t=>T(t.target.value)}),e.jsx(te,{children:e.jsx(A,{icon:J})})]}),e.jsxs(ae,{value:y,onChange:t=>S(t.target.value),style:{width:"150px"},children:[e.jsx("option",{value:"all",children:"All Requests"}),e.jsx("option",{value:"last24",children:"Last 24 Hours"}),e.jsx("option",{value:"recent",children:"Recent (Last 7 Days)"}),e.jsx("option",{value:"old",children:"Older"})]})]})]}),e.jsx(Y,{children:R?e.jsxs("div",{className:"text-center",children:[e.jsx(Q,{color:"primary"}),e.jsx("p",{children:"Loading..."})]}):C.length===0?e.jsx("div",{className:"text-center",children:e.jsx("p",{children:"No leave request found."})}):e.jsxs(e.Fragment,{children:[e.jsxs(re,{hover:!0,responsive:!0,children:[e.jsx(se,{children:e.jsxs(H,{children:[e.jsx(o,{children:"#"}),e.jsx(o,{children:"Employee"}),e.jsx(o,{children:"Date Requested"}),e.jsx(o,{children:"Leave Type"}),e.jsx(o,{children:"Days"}),e.jsx(o,{children:"Status"}),e.jsx(o,{children:"Paid"}),e.jsx(o,{children:"Actions"})]})}),e.jsx(ne,{children:C.map((t,r)=>e.jsxs(H,{children:[e.jsx(d,{children:(l-1)*m+r+1}),e.jsx(d,{children:t.name}),e.jsx(d,{children:new Date(t.created_at).toLocaleDateString()}),e.jsx(d,{children:t.leave_type}),e.jsx(d,{children:t.total_days}),e.jsx(d,{children:e.jsx(le,{color:v(t.status),children:t.status})}),e.jsx(d,{children:e.jsx(q,{id:`paid-checkbox-${t.id}`,checked:t.is_paid,onChange:()=>{}})}),e.jsxs(d,{children:[e.jsx(K,{color:"link",children:e.jsx(A,{icon:U})}),e.jsxs(ie,{children:[e.jsx(ce,{color:"link",size:"sm",children:e.jsx(A,{icon:W})}),e.jsxs(oe,{children:[e.jsx(D,{onClick:()=>x(t.id,"Approved"),disabled:t.status==="Approved",children:"Approved"}),e.jsx(D,{onClick:()=>x(t.id,"Rejected"),disabled:t.status==="Rejected",children:"Rejected"}),e.jsx(D,{onClick:()=>x(t.id,"Pending"),disabled:t.status==="Pending",children:"Pending"})]})]})]})]},t.id))})]}),e.jsxs(de,{align:"center",className:"mt-3",children:[e.jsx(I,{disabled:l===1,onClick:()=>u(l-1),children:"«"}),Array.from({length:E},(t,r)=>e.jsx(I,{active:r+1===l,onClick:()=>u(r+1),children:r+1},r+1)),e.jsx(I,{disabled:l===E,onClick:()=>u(l+1),children:"»"})]})]})})]})};export{ye as default};
