import{r as n,j as e,C as N,m as i}from"./index-CI71MjTN.js";import{a as m,F as S,s as I,t as k,v as R}from"./index-kDb0uygZ.js";import{C as L,a as z}from"./CRow-DMP-P2bV.js";import{C as G,a as V}from"./CCardBody-DgPrRQz4.js";import{C as $}from"./CCardHeader-C3Gopp4d.js";import{C as q,a as J,b as f,c as p,d as K,e as r}from"./CTable-CgnAn3TU.js";import{C as O,a as Q,b as U,c as W}from"./CModalTitle-BGXgQtMg.js";import{C as T}from"./CInputGroup-1x7vas0v.js";import{C as E}from"./CInputGroupText-DSEtVRUT.js";import{C as X}from"./CFormSelect-B5g7FNJw.js";import{C as Y}from"./CFormInput-B86EJyjV.js";import{C as Z}from"./CModalFooter-DImQ-_tK.js";import"./DefaultLayout-DzcsRVKF.js";import"./CFormControlWrapper-dYdW8KFX.js";const he=()=>{const[u,x]=n.useState(""),[j,C]=n.useState(""),[B,y]=n.useState([]),[b,h]=n.useState(!1),[v,l]=n.useState(null),[F,o]=n.useState(!1),[g,w]=n.useState(null),A=["Pag-ibig","SSS","PhilHealth","13th Month Pay","Service Incentive Leave"];n.useEffect(()=>{(async()=>{try{h(!0);const a=await i.get("/benefits");y(a.data)}catch(a){console.error("Error fetching benefits:",a),l("Failed to fetch benefits.")}finally{h(!1)}})()},[]);const M=async()=>{var a,c,d;if(!u||!j){l("Please select a benefit type and enter an amount.");return}h(!0),l(null);const s={type:u,amount:parseFloat(j)};try{if(g)await i.put(`/api/benefits/${g.id}`,s),alert("Benefit updated successfully!");else{const H=await i.post("/benefits",s);console.log("Success:",H.data),alert("Benefit applied successfully!")}const t=await i.get("/benefits");y(t.data),o(!1),x(""),C(""),w(null)}catch(t){console.error("Error:",((a=t.response)==null?void 0:a.data)||t.message),l(((d=(c=t.response)==null?void 0:c.data)==null?void 0:d.error)||"Failed to apply/update benefit.")}finally{h(!1)}},P=async s=>{var a,c,d;if(window.confirm("Are you sure you want to delete this benefit?"))try{await i.delete(`/api/benefits/${s}`),alert("Benefit deleted successfully!");const t=await i.get("/benefits");y(t.data)}catch(t){console.error("Error:",((a=t.response)==null?void 0:a.data)||t.message),l(((d=(c=t.response)==null?void 0:c.data)==null?void 0:d.error)||"Failed to delete benefit.")}},D=s=>{w(s),x(s.type),C(s.amount),o(!0)};return e.jsx(L,{children:e.jsx(z,{xs:12,children:e.jsxs(G,{className:"mb-4",children:[e.jsxs($,{children:[e.jsx("strong",{children:"Manage Employee Benefits"}),e.jsx(m,{color:"primary",className:"float-end",onClick:()=>o(!0),children:e.jsx(S,{icon:I,className:"me-2"})})]}),e.jsxs(V,{children:[v&&e.jsx("div",{className:"alert alert-danger mb-3",children:v}),e.jsxs(q,{striped:!0,hover:!0,responsive:!0,children:[e.jsx(J,{children:e.jsxs(f,{children:[e.jsx(p,{children:"ID"}),e.jsx(p,{children:"Name"}),e.jsx(p,{children:"Benefit Type"}),e.jsx(p,{children:"Amount"}),e.jsx(p,{children:"Actions"})]})}),e.jsx(K,{children:b?e.jsx(f,{children:e.jsxs(r,{colSpan:5,className:"text-center",children:[e.jsx(N,{}),e.jsx("span",{className:"ms-2",children:"Loading benefits..."})]})}):B.length===0?e.jsx(f,{children:e.jsx(r,{colSpan:5,className:"text-center",children:"No benefits found"})}):B.map(s=>e.jsxs(f,{children:[e.jsx(r,{children:s.id}),e.jsx(r,{children:s.name}),e.jsx(r,{children:s.type}),e.jsxs(r,{children:["â‚±",parseFloat(s.amount).toLocaleString("en-PH",{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsxs(r,{children:[e.jsx(m,{color:"warning",size:"sm",onClick:()=>D(s),className:"me-2",children:e.jsx(S,{icon:k})}),e.jsx(m,{color:"danger",size:"sm",onClick:()=>P(s.id),children:e.jsx(S,{icon:R})})]})]},s.id))})]}),e.jsxs(O,{visible:F,onClose:()=>o(!1),children:[e.jsx(Q,{children:e.jsx(U,{children:g?"Edit Benefit":"Add New Benefit"})}),e.jsxs(W,{children:[e.jsxs(T,{className:"mb-3",children:[e.jsx(E,{children:"Benefit Type"}),e.jsxs(X,{value:u,onChange:s=>x(s.target.value),children:[e.jsx("option",{value:"",children:"Select benefit type"}),A.map((s,a)=>e.jsx("option",{value:s,children:s},a))]})]}),e.jsxs(T,{className:"mb-3",children:[e.jsx(E,{children:"Amount"}),e.jsx(Y,{type:"number",placeholder:"Enter amount",value:j,onChange:s=>C(s.target.value)})]})]}),e.jsxs(Z,{children:[e.jsx(m,{color:"secondary",onClick:()=>o(!1),children:"Cancel"}),e.jsx(m,{color:"primary",onClick:M,disabled:b,children:b?e.jsxs(e.Fragment,{children:[e.jsx(N,{component:"span",size:"sm","aria-hidden":"true"}),e.jsx("span",{className:"ms-2",children:"Processing..."})]}):"Submit"})]})]})]})]})})})};export{he as default};
