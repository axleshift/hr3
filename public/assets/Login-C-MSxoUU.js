import{r,k as b,i as v,j as e,C as w,L as N,m as I,l as L}from"./index-Y44Ldxrt.js";import{b as _,F as u,f as E,c as k,a as x}from"./index-BrEmiYF0.js";import{C as h,a as o}from"./CRow-BZ_9_XYM.js";import{C as F,a as R}from"./CCardBody-CBtb8McC.js";import{C as T,a as U}from"./CForm-qMLrmxec.js";import{C as g,a as j}from"./CInputGroupText-B7ae_Uws.js";import{C as f}from"./CFormInput-CAbFzxsM.js";import"./CFormControlWrapper-mr0PDOF2.js";const $=()=>{const[i,C]=r.useState(""),[n,y]=r.useState(""),[l,c]=r.useState(!1),[t,d]=r.useState({visible:!1,type:"",message:""}),m=b(),p=v(),S=async a=>{a.preventDefault(),c(!0);try{const s=await I.post("/auth/login",{username:i,password:n});m({type:"SET_USER",payload:s.data.user}),m({type:"SET_SESSION_ID",payload:s.data.session_id}),L.set("dcims",s.data.session_id,{expires:30}),sessionStorage.setItem("session_id",s.data.session_id),sessionStorage.setItem("role",s.data.user.role),sessionStorage.setItem("employee_id",s.data.user.employee_id),sessionStorage.setItem("name",s.data.user.name),p("/dashboard")}catch{d({visible:!0,type:"danger",message:"Login failed. Please check your credentials."})}finally{c(!1)}};return r.useEffect(()=>{if(t.visible){const a=setTimeout(()=>d({...t,visible:!1}),3e3);return()=>clearTimeout(a)}},[t]),e.jsx("div",{className:"bg-light min-vh-100 d-flex flex-row align-items-center justify-content-center",children:e.jsx(_,{children:e.jsx(h,{className:"justify-content-center",children:e.jsx(o,{xs:12,sm:10,md:8,lg:5,children:e.jsx(F,{className:"shadow-sm p-4 border-0 rounded",children:e.jsx(R,{children:e.jsxs(T,{onSubmit:S,children:[e.jsx("h2",{className:"text-center fw-bold",children:"Login"}),e.jsx("p",{className:"text-center text-muted",children:"Sign in to your account"}),t.visible&&e.jsx(U,{color:t.type,className:"mb-3",children:t.message}),e.jsxs(g,{className:"mb-3",children:[e.jsx(j,{children:e.jsx(u,{icon:E})}),e.jsx(f,{type:"text",placeholder:"Username",value:i,onChange:a=>C(a.target.value),required:!0})]}),e.jsxs(g,{className:"mb-3",children:[e.jsx(j,{children:e.jsx(u,{icon:k})}),e.jsx(f,{type:"password",placeholder:"Password",value:n,onChange:a=>y(a.target.value),required:!0})]}),e.jsxs(h,{children:[e.jsx(o,{children:e.jsx(x,{type:"submit",color:"primary",className:"w-100",disabled:l,children:l?e.jsx(w,{component:"span",size:"sm","aria-hidden":"true"}):"Login"})}),e.jsx(o,{children:e.jsx(x,{color:"light",className:"w-100",onClick:()=>p("/Register"),children:"Register"})})]}),e.jsx("div",{className:"text-center mt-3",children:e.jsx(N,{to:"/forgot-password",className:"text-decoration-none",children:"Forgot password?"})})]})})})})})})})};export{$ as default};
